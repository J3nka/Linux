#!/usr/local/bin/python3.7 -B

import json
import re
import time
import os
import subprocess
import signal
import sys
from optparse import OptionParser

pythonlib = os.path.abspath(os.path.join(os.path.dirname(__file__), '..', 'lib', 'python'))
if not pythonlib in sys.path:
    sys.path.insert(1, pythonlib)
del pythonlib

from Webscraper.Anime_downloader import Anime_downloader as AD

def signal_handler(sig, frame):
        print('\nAborting script!')
        sys.exit(0)
signal.signal(signal.SIGINT, signal_handler)

parser = OptionParser(
    description="Script to scrape websites for torrents/magnet links then adds them to deluge",
    epilog="Written by Martin Falkmer"
)

parser.add_option("-p", "--provider", dest="provider", help="Which provider to use [horriblesubs, erai_raws] default is erai_raws", default="erai_raws")

(options, args) = parser.parse_args()

try:
    anime_downloader = AD(options.provider, ' '.join(args))
    anime_downloader.run()
except ValueError as error:
    print(error)
    sys.exit("Aborting script!")

sys.exit("DONE!")
